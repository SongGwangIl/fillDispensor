<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="timepill.user.service.impl.UserDAO">

  <select id="login">
  	SELECT 
  		A.user_id
  		, password
  		, email
  		, user_status
  		, user_carer_at
  		, user_name
  		, user_phone
    FROM users A 
    	LEFT JOIN user_info B 
    	ON A.user_id = B.user_id 
    WHERE A.user_id = #{userId}
  </select>
  <insert id="add">
  	INSERT INTO users (
  		user_id
  		, password
  		, email
  		, user_carer_at)
  	VALUES (
  		#{userId}
  		, #{password}
  		, #{email}
  		, #{userCarerAt})
  </insert>
  <select id="checkId" resultType="String">
  	SELECT COUNT(*) 
  	FROM users 
  	WHERE user_id = #{userId}
  </select>
  <select id="getUserName">
  	SELECT user_name
  	FROM user_info
  	WHERE user_id = #{userId}
  </select>
  <insert id="addUserInfo">
  	INSERT INTO user_info(
  		user_id
  		, user_name
  		, user_phone
  		, user_gender
  		, user_height
  		, user_weight
  		, user_birth)
  	values(
  		#{userId}
  		, #{userName}
  		, #{userPhone}
  		, #{userGender}
  		, #{userHeight}
  		, #{userWeight}
  		, #{userBirth})
  </insert>
  <select id="getUserInfo">
  	SELECT user_id
	  	, user_name
	  	, user_phone
	  	, user_gender
	  	, user_height
	  	, user_weight
	  	, user_birth
  	FROM user_info
  	WHERE user_id = #{userId}
  </select>
  <select id="getUserCarerAt">
  	SELECT user_carer_at
    FROM users
    WHERE user_id = #{userId}
  </select>
  <update id="updateUserInfo">
  	UPDATE user_info 
  	SET user_name = #{userName}
	  	, user_phone = #{userPhone}
	  	, user_gender = #{userGender}
	  	, user_height = #{userHeight}
	  	, user_weight = #{userWeight}
	  	, user_birth = #{userBirth}	 	
  	WHERE user_id = #{userId}
  </update>
  <update id="updateCarerInfo">
  	UPDATE user_info 
  	SET user_name = #{userName}, user_phone = #{userPhone} 
  	WHERE user_id = #{userId}
  </update>
</mapper>